<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ferretería Q10 — Tu tienda de herramientas y materiales de confianza.">
    <title>{% block title %}Ferretería Dani{% endblock %}</title>

    {# ── Bootstrap 5.3 CSS ─────────────────────────────────────────── #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    {# ── Bootstrap Icons ───────────────────────────────────────────── #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">

    {# ── Estilos personalizados ────────────────────────────────────── #}
    <style>
        :root {
            --ferr-primary:   #D97706;
            --ferr-secondary: #1E3A5F;
            --ferr-accent:    #F59E0B;
            --ferr-bg:        #F8F5F0;
            --ferr-dark:      #1a1a2e;
            --ferr-card-bg:   #ffffff;
        }

        /* ── Skip-to-content para accesibilidad ────────────────────── */
        .skip-link {
            position: absolute;
            top: -100%;
            left: 0;
            background: var(--ferr-primary);
            color: #fff;
            padding: .5rem 1rem;
            z-index: 1100;
            transition: top .2s;
        }
        .skip-link:focus { top: 0; }

        body {
            background-color: var(--ferr-bg);
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* ── Navbar ───────────────────────────────────────────────── */
        .navbar-ferr {
            background: linear-gradient(135deg, var(--ferr-secondary) 0%, var(--ferr-dark) 100%);
            box-shadow: 0 2px 15px rgba(0,0,0,.25);
        }
        .navbar-ferr .navbar-brand {
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--ferr-accent) !important;
            letter-spacing: .5px;
        }
        .navbar-ferr .nav-link {
            color: rgba(255,255,255,.85) !important;
            font-weight: 500;
            transition: color .2s;
        }
        .navbar-ferr .nav-link:hover,
        .navbar-ferr .nav-link:focus {
            color: var(--ferr-accent) !important;
        }
        .navbar-ferr .badge { font-size: .7rem; }
        .navbar-ferr .dropdown-menu {
            border: none;
            box-shadow: 0 8px 25px rgba(0,0,0,.15);
            border-radius: .5rem;
        }
        .navbar-ferr .dropdown-item:hover {
            background-color: rgba(217,119,6,.1);
            color: var(--ferr-primary);
        }
        .navbar-ferr .dropdown-item i {
            width: 1.2rem;
            text-align: center;
        }

        /* ── Hero section ────────────────────────────────────────── */
        .hero-section {
            background: linear-gradient(135deg, var(--ferr-secondary) 0%, #2d5a8e 50%, var(--ferr-primary) 100%);
            color: #fff;
            padding: 3rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .hero-section::after {
            content: '';
            position: absolute;
            top: 0; right: 0; bottom: 0; left: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            pointer-events: none;
        }
        .hero-section h1 {
            font-weight: 800;
            text-shadow: 0 2px 10px rgba(0,0,0,.3);
        }

        /* ── Cards ───────────────────────────────────────────────── */
        .card-producto {
            border: none;
            border-radius: .75rem;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,.08);
            transition: transform .25s ease, box-shadow .25s ease;
        }
        .card-producto:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(0,0,0,.15);
        }
        .card-producto .card-img-top {
            height: 220px;
            object-fit: cover;
        }
        .card-producto .badge-stock {
            position: absolute;
            top: .75rem;
            right: .75rem;
        }

        /* ── Footer ──────────────────────────────────────────────── */
        .footer-ferr {
            background: linear-gradient(135deg, var(--ferr-dark) 0%, var(--ferr-secondary) 100%);
            color: rgba(255,255,255,.7);
            margin-top: auto;
        }
        .footer-ferr a {
            color: var(--ferr-accent);
            text-decoration: none;
        }
        .footer-ferr a:hover { color: #fff; }

        /* ── Botones ─────────────────────────────────────────────── */
        .btn-ferr {
            background: linear-gradient(135deg, var(--ferr-primary) 0%, var(--ferr-accent) 100%);
            color: #fff;
            border: none;
            font-weight: 600;
            border-radius: .5rem;
            transition: opacity .2s, transform .15s;
        }
        .btn-ferr:hover {
            opacity: .9;
            transform: scale(1.03);
            color: #fff;
        }

        /* ── Accesibilidad: focus visible ────────────────────────── */
        *:focus-visible {
            outline: 3px solid var(--ferr-accent);
            outline-offset: 2px;
        }

        /* ── Toast container ─────────────────────────────────────── */
        .toast-container-custom {
            position: fixed;
            top: 5rem;
            right: 1rem;
            z-index: 1090;
            max-width: 400px;
        }

        /* ── Profile card ────────────────────────────────────────── */
        .profile-card {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,.08);
        }
    </style>

    {% block stylesheets %}{% endblock %}
</head>

<body>
    {# ── Skip-to-content (accesibilidad WCAG 2.1) ─────────────────── #}
    <a class="skip-link" href="#main-content">Saltar al contenido principal</a>

    {# ── Navbar ────────────────────────────────────────────────────── #}
    <nav class="navbar navbar-expand-lg navbar-dark navbar-ferr sticky-top"
         aria-label="Navegación principal">
        <div class="container">
            <a class="navbar-brand" href="{{ path('catalog_index') }}">
                <i class="bi bi-tools me-2" aria-hidden="true"></i>Ferretería Dani
            </a>

            <button class="navbar-toggler" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#mainNav"
                    aria-controls="mainNav"
                    aria-expanded="false"
                    aria-label="Abrir menú de navegación">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="mainNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ path('catalog_index') }}">
                            <i class="bi bi-shop me-1" aria-hidden="true"></i>Catálogo
                        </a>
                    </li>
                    {% if is_granted('ROLE_ADMIN') %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ path('admin_index') }}">
                            <i class="bi bi-gear me-1" aria-hidden="true"></i>Panel Admin
                        </a>
                    </li>
                    {% endif %}
                </ul>

                <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link position-relative" href="{{ path('cart_index') }}"
                           aria-label="Ver carrito de compras">
                            <i class="bi bi-cart3 me-1" aria-hidden="true"></i>Carrito
                        </a>
                    </li>

                    {% if app.user %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button"
                           data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-person-circle me-1" aria-hidden="true"></i>{{ app.user.userIdentifier }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li>
                                <a class="dropdown-item" href="{{ path('app_profile') }}">
                                    <i class="bi bi-person-gear me-2" aria-hidden="true"></i>Mi cuenta
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item text-danger" href="{{ path('app_logout') }}">
                                    <i class="bi bi-box-arrow-right me-2" aria-hidden="true"></i>Cerrar sesión
                                </a>
                            </li>
                        </ul>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{{ path('app_login') }}">
                            <i class="bi bi-box-arrow-in-right me-1" aria-hidden="true"></i>Iniciar sesión
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ path('app_register') }}">
                            <i class="bi bi-person-plus me-1" aria-hidden="true"></i>Registrarse
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    {# ── Toast notifications ──────────────────────────────────────── #}
    <div class="toast-container-custom" aria-live="polite">
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                {% set toast_bg = label == 'success' ? 'bg-success' : (label == 'danger' ? 'bg-danger' : (label == 'warning' ? 'bg-warning text-dark' : 'bg-info')) %}
                <div class="toast align-items-center text-white {{ toast_bg }} border-0 show" role="alert" aria-atomic="true" data-bs-autohide="true" data-bs-delay="4000">
                    <div class="d-flex">
                        <div class="toast-body fw-semibold">
                            {% if label == 'success' %}<i class="bi bi-check-circle-fill me-2"></i>{% endif %}
                            {% if label == 'danger' %}<i class="bi bi-exclamation-triangle-fill me-2"></i>{% endif %}
                            {{ message }}
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
                    </div>
                </div>
            {% endfor %}
        {% endfor %}
    </div>

    {# ── Contenido principal ───────────────────────────────────────── #}
    <main id="main-content" role="main" class="flex-grow-1">
        {% block body %}{% endblock %}
    </main>

    {# ── Footer ────────────────────────────────────────────────────── #}
    <footer class="footer-ferr py-4 mt-5" role="contentinfo">
        <div class="container">
            <div class="row g-4">
                <div class="col-md-4">
                    <h5 class="text-white mb-3">
                        <i class="bi bi-tools me-2" aria-hidden="true"></i>Ferretería Dani
                    </h5>
                    <p class="small">Tu tienda de herramientas y materiales de confianza. Calidad profesional para todos tus proyectos.</p>
                </div>
                <div class="col-md-4">
                    <h5 class="text-white mb-3">Contacto</h5>
                    <ul class="list-unstyled small">
                        <li><i class="bi bi-geo-alt me-1" aria-hidden="true"></i>C/ Bartolome , 10 — Castellón</li>
                        <li><i class="bi bi-telephone me-1" aria-hidden="true"></i>+34 123 456 789</li>
                        <li><i class="bi bi-envelope me-1" aria-hidden="true"></i>dantejmar@alu.edu.gva.es</li>
                    </ul>
                </div>
            </div>
            <hr class="border-secondary my-3">
            <p class="text-center small mb-0">&copy; {{ "now"|date("Y") }} Ferretería Dani. Todos los derechos reservados.</p>
        </div>
    </footer>

    {# ── Bootstrap 5.3 JS Bundle ──────────────────────────────────── #}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    {# ── Auto-initialize toasts ───────────────────────────────────── #}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.toast.show').forEach(function(el) {
                var toast = new bootstrap.Toast(el);
                toast.show();
            });
        });
    </script>

    {% block javascripts %}{% endblock %}
</body>
</html>
